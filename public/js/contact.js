$(document).ready(function(){var a,e=$(".favoritesGroup"),i=$(".favoritesList"),t=$(".inputGroup"),n=$(".options"),r=$(".button--contactSubmit"),s=function(){$.each(t,function(a,e){var i=$($(e)[0]),t=i.find("input, textarea, ul.options"),n=i.attr("data-validateAs"),r=i.hasClass("required"),s=i.find(".errors"),o={inputGroup:i,validateAs:n,required:r,errorList:s};if("UL"===t[0].tagName){var l,p=$(t).find("li"),c=[];$.each(p,function(a,e){l=$(e)[0].innerHTML,c.push(l)}),o.value=$(t).find(".active")[0].innerHTML,o.options=c}else o.value=t[0].value;u(o)});var e=$(".invalid").length;if(0===e){var i={name:$(".inputGroup.name input").val(),email:$(".inputGroup.email input").val(),interest:$(".inputGroup.interest li.active")[0].innerHTML,message:$(".inputGroup.message textarea").val(),favoritesHTML:""};a&&a.length>0&&(i.favoritesHTML="<h2>Favorite Pieces</h2>",$.each(a,function(a,e){i.favoritesHTML+='<a href="http://dev.arabianfancy.com/img/tack/arabian-fancy-tack_'+e+'.jpg"><img src="http://dev.arabianfancy.com/img/tack/arabian-fancy-tack_'+e+'.jpg"></a>'})),p(i)}},o=function(a){var e=$(a.currentTarget),i=e.val(),t=e.parent(),n=t.attr("data-validateAs"),r=t.hasClass("required"),s=t.find(".errors");data={inputGroup:t,field:e,value:i,validateAs:n,required:r,errorList:s},u(data)},u=function(a){var e,i=a.errorList,t=a.value,n=a.validateAs,r={required:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*(_|[^\w])).+$/,string:/^[A-z0-9\s\.\,\:\;\!\?\(\)\/\-\'\"]*$/,email:/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,options:[]},s=r[n],o=a.required,u=e=i.find(".error--invalid");if(o){if(e=i.find(".error--required"),""===t)return a.inputGroup.removeClass("valid"),a.inputGroup.addClass("invalid"),e.show(),u.hide(),!1;e.hide()}else if(!o&&""===t)return!1;a.options?(optionValid=$.inArray(a.value,a.options),-1!==optionValid?(a.inputGroup.removeClass("invalid"),a.inputGroup.addClass("valid"),u.hide()):(a.inputGroup.removeClass("valid"),a.inputGroup.addClass("invalid"),u.show())):s.test(t)?(a.inputGroup.removeClass("invalid"),a.inputGroup.addClass("valid"),u.hide()):(a.inputGroup.removeClass("valid"),a.inputGroup.addClass("invalid"),u.show())},l=function(a){var e=$(a.currentTarget),i=e.parent(),t=i.find("li");$.each(t,function(){$(this).removeClass("active")}),e.addClass("active")},p=function(a){$(".spinner").addClass("show"),$.ajax({type:"POST",url:"https://mandrillapp.com/api/1.0/messages/send-template.json",data:{key:"RlbIXfpr5DzI8fsRNzXILw",template_name:"arabian-fancy-contact-form",template_content:[{name:"heading",content:"You've got a message from ArabianFancy.com!"},{name:"name",content:a.name},{name:"interest",content:a.interest},{name:"message",content:a.message},{name:"favorites",content:a.favoritesHTML}],message:{from_email:a.email,to:[{email:"arabianfancy@live.com",name:"Gina Dupree",type:"to"}],headers:{"Reply-To":a.email},autotext:"true",subject:"Message from ArabianFancy.com"}},success:function(){$(".spinner").removeClass("show"),$(".contactFormContainer").slideUp("slow",function(){$(".contactSuccess").slideDown()}),sessionStorage.removeItem("favoritesIDs")}})};sessionStorage.getItem("favoritesIDs")&&(a=JSON.parse(sessionStorage.favoritesIDs),a.length>0&&(e.removeClass("noFavorites"),$.each(a,function(a,e){i.append('<li><img src="img/tack/arabian-fancy-tack_'+e+'.jpg"></li>')}))),n.on("click","li",l),t.on("blur","input, textarea, ul.options",o),r.on("click",s)});